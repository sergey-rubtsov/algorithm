Тестовое задание на вакансию Java-программист.

В целях оптимизации затрат на персонал менеджером клиники "Заветы Гиппократа" Волковым А.Д. было сделано предложение заменить медицинских регистраторов человекоподобными роботами. Для этого в информационную систему клиники необходимо внести изменения, позволяющие пациенту заказывать необходимые услуги без участия человека. Бизнес-аналитик Рыжий Б.А. предложил следующую модель процесса заказа услуг.

1. В клинике работает D врачей (D <= 1000).
2. Врачами клиники оказывается S различных услуг (S <= 1000).
3. Рабочий день клиники состоит из T минут (T <= 600).
4. Для каждой из услуг известна ее продолжительность в минутах.
5. В один момент времени одному пациенту может быть оказана только одна услуга.
6. Все время оказания услуги должно целиком лежать в рабочем дне клиники.
7. Для каждой пары (врач, услуга) заданы моменты времени, в которые врач может начать оказывать эту услугу.

При заказе пациент сообщает набор необходимых ему услуг в количестве P (P <= 10). В результате пациент должен получить для каждой из заказанных услуг время начала оказания услуги и врача, который будет ее оказывать. Если оказать все заказанные услуги в течение рабочего дня клиники не представляется возможным, пациента должны известить об этом.

Общее время нахождения пациента в клинике определяется как разность между временем конца самой поздней в рабочем дне услуги и началом самой ранней. Пациенты не любят находиться в клинике слишком долго, поэтому общее время пребывания пациента в клинике должно быть сведено к минимуму.

---

Для решения задачи необходимо разработать программу на языке программирования Java (без использования каких-либо сторонних библиотек кроме JRE).

Файл с входными данными имеет следующий формат (нумерация с нуля, в качестве разделителя используется символ пробела, для переноса строк используются символы \r, \n или \r\n). Гарантируется корректность входных данных.

количество врачей D
количество различных услуг S
количество минут в рабочем дне T
продолжительность каждой из услуг
набор услуг, заказанный пациентом
(врач, услуга, время в минутах от начала рабочего дня) означает, что указанный врач может оказывать указанную услугу в указанное времени (время начала услуги)

Пример входных данных.
2
3
11
2 4 3
0 2
0 0 0
0 0 1
0 2 0
0 2 1
0 2 4
0 0 3
1 1 4
1 2 5
1 0 9

Результатом работы программы является файл следующего формата (или пустой файл, если оказать выбранные услуги в течение рабочего дня невозможно).

(услуга, врач, время начала оказания услуги)

Пример (для приведенных выше входных данных).
0 0 3
2 1 5

Программа должна выполняться за разумное время (< 10 секунд) на современном компьютере при указанных ограничениях на входные данные.

---

Дополнительные данные

1
10
600
1 4 5 3 1 4 2 2 5 5
0 1 2 3 4 5 6 7 8 9
0 0 343
0 0 136
0 0 274
0 0 2
0 0 473
0 0 545
0 0 77
0 0 347
0 0 75
0 0 462
0 0 155
0 0 460
0 0 262
0 0 320
0 0 23
0 0 560
0 0 82
0 0 95
0 0 452
0 0 175
0 0 524
0 0 525
0 0 435
0 0 41
0 0 587
0 0 437
0 0 44
0 0 288
0 0 492
0 0 291
0 0 53
0 0 112
0 0 598
0 0 530
0 0 484
0 0 245
0 0 62
0 0 538
0 0 303
0 1 137
0 1 551
0 1 207
0 1 408
0 1 477
0 1 547
0 1 338
0 1 472
0 1 67
0 1 469
0 1 552
0 1 220
0 1 326
0 1 258
0 1 462
0 1 16
0 1 257
0 1 573
0 1 208
0 1 451
0 1 388
0 1 518
0 1 505
0 1 501
0 1 43
0 1 587
0 1 589
0 1 497
0 1 319
0 1 105
0 1 318
0 1 535
0 1 117
0 1 358
0 1 246
0 1 416
0 1 543
0 1 180
0 1 241
0 2 67
0 2 351
0 2 471
0 2 468
0 2 130
0 2 404
0 2 134
0 2 405
0 2 222
0 2 157
0 2 397
0 2 267
0 2 265
0 2 450
0 2 90
0 2 171
0 2 580
0 2 163
0 2 586
0 2 165
0 2 523
0 2 119
0 2 288
0 2 592
0 2 357
0 2 184
0 2 116
0 2 114
0 2 53
0 2 531
0 2 530
0 2 297
0 2 125
0 2 298
0 2 486
0 2 421
0 2 536
0 2 362
0 2 423
0 2 241
0 3 275
0 3 341
0 3 71
0 3 78
0 3 557
0 3 406
0 3 193
0 3 75
0 3 16
0 3 155
0 3 459
0 3 23
0 3 158
0 3 94
0 3 29
0 3 440
0 3 516
0 3 517
0 3 577
0 3 35
0 3 233
0 3 311
0 3 515
0 3 310
0 3 108
0 3 586
0 3 41
0 3 228
0 3 45
0 3 190
0 3 353
0 3 113
0 3 249
0 3 541
0 3 178
0 3 125
0 3 245
0 3 62
0 4 69
0 4 548
0 4 2
0 4 339
0 4 141
0 4 278
0 4 67
0 4 77
0 4 72
0 4 13
0 4 553
0 4 81
0 4 563
0 4 562
0 4 260
0 4 560
0 4 391
0 4 90
0 4 34
0 4 102
0 4 373
0 4 101
0 4 512
0 4 173
0 4 232
0 4 380
0 4 229
0 4 316
0 4 589
0 4 438
0 4 498
0 4 184
0 4 534
0 4 115
0 4 491
0 4 178
0 4 182
0 4 481
0 5 550
0 5 274
0 5 70
0 5 475
0 5 200
0 5 472
0 5 77
0 5 193
0 5 72
0 5 346
0 5 552
0 5 345
0 5 462
0 5 393
0 5 257
0 5 260
0 5 219
0 5 159
0 5 335
0 5 214
0 5 26
0 5 517
0 5 32
0 5 526
0 5 105
0 5 50
0 5 290
0 5 185
0 5 48
0 5 494
0 5 528
0 5 54
0 5 113
0 5 189
0 5 543
0 5 243
0 5 302
0 5 120
0 5 422
0 6 137
0 6 477
0 6 279
0 6 400
0 6 11
0 6 405
0 6 194
0 6 324
0 6 257
0 6 216
0 6 386
0 6 95
0 6 94
0 6 571
0 6 328
0 6 569
0 6 34
0 6 580
0 6 174
0 6 582
0 6 446
0 6 447
0 6 496
0 6 438
0 6 44
0 6 523
0 6 186
0 6 492
0 6 358
0 6 184
0 6 535
0 6 253
0 6 488
0 6 248
0 6 52
0 6 189
0 6 355
0 6 126
0 6 124
0 6 243
0 7 551
0 7 136
0 7 341
0 7 415
0 7 8
0 7 471
0 7 192
0 7 85
0 7 462
0 7 153
0 7 223
0 7 18
0 7 217
0 7 562
0 7 219
0 7 386
0 7 215
0 7 451
0 7 29
0 7 570
0 7 388
0 7 103
0 7 510
0 7 175
0 7 36
0 7 311
0 7 524
0 7 312
0 7 316
0 7 164
0 7 357
0 7 535
0 7 595
0 7 426
0 7 599
0 7 417
0 7 360
0 8 68
0 8 412
0 8 76
0 8 349
0 8 556
0 8 79
0 8 567
0 8 327
0 8 154
0 8 459
0 8 262
0 8 20
0 8 93
0 8 27
0 8 384
0 8 269
0 8 577
0 8 441
0 8 174
0 8 370
0 8 507
0 8 526
0 8 40
0 8 521
0 8 438
0 8 498
0 8 523
0 8 186
0 8 252
0 8 534
0 8 54
0 8 293
0 8 418
0 8 63
0 8 62
0 8 122
0 8 180
0 9 411
0 9 340
0 9 206
0 9 549
0 9 415
0 9 277
0 9 6
0 9 276
0 9 77
0 9 287
0 9 555
0 9 14
0 9 155
0 9 262
0 9 562
0 9 561
0 9 321
0 9 29
0 9 328
0 9 96
0 9 97
0 9 500
0 9 432
0 9 111
0 9 526
0 9 228
0 9 317
0 9 589
0 9 522
0 9 498
0 9 288
0 9 186
0 9 253
0 9 247
0 9 416
0 9 298
0 9 123
0 9 420

С помощью жадного алгоритма можно быстро найти вариант со временем 39 минут. Хотя существует вариант на 37 минут:

2 0 90
6 0 95
9 0 97
4 0 102
7 0 103
5 0 105
0 0 112
3 0 113
1 0 117
8 0 122

Бонусное задание.

В связи с увеличением потока пациентов было принято решение дать возможность заказывать услуги не только на текущий день, но и на A дней вперед (A <= 60).

В модель были внесены следующие изменения. Общее время нахождения пациента в клинике определяется как сумма разностей между временем конца самой поздней услуги в рабочем дне и началом самой ранней для каждого дня, в которые пациенту будут оказывать услуги, плюс общее количество дней, в которые пациенту будут оказываться услуги, умноженное на сумму продолжительностей заказанных услуг. Необходимо свести к минимуму общее время нахождения пациента в клинике.

Формат входных данных теперь имеет следующий вид.

количество врачей D
количество различных услуг S
количество дней A
количество минут в рабочем дне T
продолжительность каждой из услуг
набор услуг, заказанный пациентом
(врач, услуга, номер дня, время в минутах от начала рабочего дня) означает, что указанный врач может оказывать указанную услугу в указанный день в указанное времени (время начала услуги)

Формат выходных данных принял следующий вид.

(услуга, врач, день, время начала оказания услуги)